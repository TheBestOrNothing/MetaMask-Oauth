<!DOCTYPE html>
<html>
    <script>
        // Configuration for your OAuth v1 app
        const config = {
            clientId: 'e3845613-0331-49c0-9f11-fb6a634242d2', // Replace with your client ID
            redirectUri: 'https://212c-34-92-204-228.ngrok-free.app/_oauth/microsoft356', // Replace with your redirect URI
            authEndpoint: 'https://login.microsoftonline.com/d5e685a9-3e23-42d9-9efa-15cc5c1ce7db/oauth2/authorize',
            tokenEndpoint: 'https://login.microsoftonline.com/d5e685a9-3e23-42d9-9efa-15cc5c1ce7db/oauth2/token',
            scopes: 'openid profile email', // Replace with the scopes you need
            state: "eyJsb2dpblN0eWxlIjoicmVkaXJlY3QiLCJjcmVkZW50aWFsVG9rZW4iOiJPdk9IemNELThhMXBwTndKUFJuU0FnY1QyTUxOZmdRLWZjaXVPYjdZQ0FPIiwiaXNDb3Jkb3ZhIjpmYWxzZSwicmVkaXJlY3RVcmwiOiJodHRwczovLzIxMmMtMzQtOTItMjA0LTIyOC5uZ3Jvay1mcmVlLmFwcC9ob21lIn0=",
            code: "abcdefg",
            session_state: "2e1ade24-bffe-46ef-b1c7-934dc8dfbd00#",

        };

        function signIn() {

            const url = new URL(window.location.href);

            // Get the query parameters
            const params = new URLSearchParams(url.search);

            // Iterate through all parameters
            params.forEach((value, name) => {
                console.log(name, value);
            });

            const redirectUrl = `${params.get('redirect_uri')}?code=${config.code}&state=${encodeURIComponent(params.get('state'))}&session_state=${encodeURIComponent(config.session_state)}`;
            window.location.href = redirectUrl;

        }

        window.onload = signIn;
    </script>
</html>